# Chapter 15, 타임라인 격리하기


## 💡 타임라인 다이어그램을 그려보고, 다이어그램으로 버그 찾아내기


❔ 문제 상황: 장바구니당 배송비가 한번만 추가되어야하는데, 빠르게 두 번 클릭시, 배송비가 2번 계산된다.
- 왜 이런 문제가 발생했는지, 타임라인 다이어그램을 그려 확인해보자.


## 타임라인 다이어그램 기본 규칙
1. 두 액션이 <u>**순서대로**</u> 나타나면, **같은 타임라인**에 넣는다.
2. 두 액션이 **동시에 실행**되거나 **순서를 예상할 수 없다**면, **분리된 타임라인**에 넣는다.

ex) 저녁 준비하기
```
function dinner(food) {
  cook(food);
  serve(food);
  eat(food);
}
```


## 타임라인 그리기

### 1단계: 액션을 확인한다.
- ++와 +=는 3단계다
- 인자는 함수를 부르기 전에 실행된다.


### 2단계: 순서대로 실행되거나, 동시에 실행되는 액션 그리기
비동기 호출은 새로운 타임라인으로 그린다.
- 단일 스레드, 동기
- 단일 스레드, 비동기
- 멀티스레드
- 메시지 패싱

순서가 섞일 수 있는 코드 VS 순서가 섞이지 않는 코드
: 순서대로 실행되는 두 액션 사이에 다른 타임라인에 있는 액션이 끼어드는 것


## 좋은 타임라인
- 타임라인을 적게
- 타임라인을 짧게
- 공유하는 자원을 적게
- 자원을 공유할 땐 서로 조율하고
- 시간을 일급으로 다룬다. ->

자바스크림트비동기큐, AJAX 이벤트큐 ??

### 3단계: 단순화하기
- 하나의 타임라인에 있는 모든 액션을 하나로 통합
- 타임라인이 끝나는 곳에서 샐운 타임라인이 하나만 생기면 통합

해당 문제 해결법
1. 공유하는 자원 없애기
  - 전역변수를 지역변수로
  - 전역변수를 인자로
2. 


### Q. 연습문제
1. 두 타임라인은 자원을 공유할 수 있다. <span style="color:red"> X </span>
2. 자원을 공유하는타임라인이 자원을 공유하지 않는 타임라인보다 안전하다.
3. 같은 타임라인에 있는 두 액션은 서로 자원을 공유하지 않도록 해야 한다.
4. 계산은 타임라인에 그릴 필요 없다.
5. 같은 타임라인에 있는 두 액션은 동시에 실행된다.
6. 자바스크립트는 스레드가 하나이기 때문에 타임라인을 무시해도 된다.
7. 서로 다른 타임라인에 있는 두 액션은 동시에 실행되거나 왼쪽 먼저, 오른쪽 먼저 실행될 수 있다.
8. 공유하는 전역변수를 없애는 방법은 인자나 지역변수를 사용하는 것이다.
9. 타임라인 다이어그램은 소프트웨어가 동작할 때 실행 가능한 순서를 이해하기 좋다.
10. 자원을 공유하는 타임라인은 타이밍 문제가 생길 수 있다.

+ 재사용하기 좋은 코드 만들기 -> 함수 본문을 콜백으로 바꾸기
+ 비동기 호출에서 명시적인 출력을 위해 리턴값 대신, 콜백을 사용할 수 있다

질문/소감
표

